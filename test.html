<!DOCTYPE html>
<html>
    <head>
        <meta content="text/html; charset=UTF-8" http-equiv="content-type">
        <title>Test for defer.js</title>
        <script src="src/defer.js" type="text/javascript"></script>
    </head>
    <body>
        <h1>Test</h1>
        <hr/>
        <h2>Case 0: direct call</h2>
        <div>Result: <span id="C0Result"></span></div>
        <h2>Case 1: after 5sec call function</h2>
        <div>Result: <span id="C1Result"></span></div>
        <h2>Case 2: call & apply</h2>
        <div>Result: <span id="C2_0Result"></span></div>
        <div>Result: <span id="C2_1Result"></span></div>
        <h2>Case 3: extra arguments</h2>
        <div>Result: <span id="C3Result"></span></div>
        <h2>Case 4: function argument</h2>
        <div>Result: <span id="C4Result"></span></div>
        <h2>Case 5: object's function</h2>
        <div>Result: <span id="C5Result"></span></div>
        <h2>Case 6: parameter multiplexing</h2>
        <div>Result: <span id="C6_0Result"></span></div>
        <div>Result: <span id="C6_1Result"></span></div>
        <h2>Case 7: function autorun</h2>
        <div>Result: <span id="C7Result"></span></div>
        <script>
            // case 0.
            var f0 = defer(function(value) {
                document.getElementById('C0Result').innerHTML = value;
            });
            f0('Case 0 called');
            // case 1.
            var f1 = defer(function(v1, v2) {
                document.getElementById('C1Result').innerHTML = v1 + v2;
            });
            setTimeout(function() {
                defer('Case 1 ') >> f1;
                defer('called') >> f1;
                f1();
            }, 5000);
            // case 2.
            var f2_0 = defer(function(value) {
                document.getElementById('C2_0Result').innerHTML = this.name + ' ' + value;
            });
            var f2_1 = defer(function(value) {
                document.getElementById('C2_1Result').innerHTML = this.name + ' ' + value;
            });
            f2_0.call({name: 'Case 2-0'}, 'called');
            f2_1.apply({name: 'Case 2-1'}, ['called']);
            // case 3.
            var f3 = defer(function(v1, v2) {
                document.getElementById('C3Result').innerHTML = v1 + v2;
            });
            defer('Case 3 ') >> f3;
            defer('called') >> f3;
            defer('extra arguments') >> f3;
            f3();
            // case 4.
            var f4 = defer(function(v1, v2) {
                document.getElementById('C4Result').innerHTML = v1() + v2;
            });
            defer(function() {
                return 'Case 4 ';
            }) >> f4;
            defer('called') >> f4;
            f4();
            // case 5.
            var obj5 = {
                name : 'Case 5',
                func : function(value) {
                    document.getElementById('C5Result').innerHTML = this.name + ' ' + value;
                }
            }
            var f5 = defer(obj5.func).setContext(obj5);
            defer('called') >> f5;
            f5();
            // case 6.
            var f6_0 = defer(function(value) {
                document.getElementById('C6_0Result').innerHTML = 'Case 6-0 ' + value;
            });
            var f6_1 = defer(function(value) {
                document.getElementById('C6_1Result').innerHTML = 'Case 6-1 ' + value;
            });
            var p6 = defer('called');
            p6 >> f6_0;
            p6 >> f6_1;
            f6_0();
            f6_1();
            // case 7.
            var f7 = defer(function(v1, v2) {
                document.getElementById('C7Result').innerHTML = v1 + v2;
            }).setAutorun(true);
            defer('Case 7 ') >> f7;
            defer('called') >> f7;
        </script>
    </body>
</html>